# yaml-language-server: $schema=../../component-metadata-schema.json
schemaVersion: v1
type: configuration
name: azure.appconfig
version: v1
status: alpha
title: "Azure Service App Configuration"
urls:
  - title: Reference
    url: https://docs.dapr.io/reference/components-reference/supported-configuration-stores/azure-appconfig-configuration-store/
capabilities: []
authenticationProfiles:
  - title: "Connection string"
    description: "Authenticate using a connection string."
    metadata:
      - name: connectionString
        required: true
        sensitive: true
        description: "The Service Bus connection string."
        example: '"Endpoint=https://foo.azconfig.io;Id=osOX-l9-s0:sig;Secret=00000000000000000000000000000000000000000000"'
        # If omitted, uses the same values as "<root>.binding"
        binding:
          output: true
          input: true
  - title: "Azure AD: Managed identity"
    description: "Authenticate using Azure AD and a managed identity."
    metadata:
      - name: azureClientId
        required: false
        description: "Client ID (application ID). Required if the service has multiple identities assigned."
        example: '"c7dd251f-811f-4ba2-a905-acd4d3f8f08b"'
  - title: "Azure AD: Client credentials"
    description: "Authenticate using Azure AD with client credentials, also known as \"service principals\"."
    metadata:
      - name: azureTenantId
        required: true
        description: "ID of the Azure AD tenant"
        example: '"cd4b2887-304c-47e1-b4d5-65447fdd542a"'
      - name: azureClientId
        required: true
        description: "Client ID (application ID)"
        example: '"c7dd251f-811f-4ba2-a905-acd4d3f8f08b"'
      - name: azureClientSecret
        sensitive: true
        required: true
        description: "Client secret (application password)"
        example: '"Ecy3XG7zVZK3/vl/a2NSB+a1zXLa8RnMum/IgD0E"'
  - title: "Azure AD: Client certificate"
    description: "Authenticate using Azure AD with a client certificate (in PFX/PKCS#12 format). One of azureCertificate and azureCertificateFile is required."
    metadata:
      - name: azureTenantId
        required: true
        description: "ID of the Azure AD tenant."
        example: '"cd4b2887-304c-47e1-b4d5-65447fdd542b"'
      - name: azureClientId
        required: true
        description: "Client ID (application ID)."
        example: '"c7dd251f-811f-4ba2-a905-acd4d3f8f08b"'
      - name: azureCertificate
        sensitive: true
        required: false
        description: "Certificate and private key (in PFX/PKCS#12 format)."
        example: |
          "-----BEGIN PRIVATE KEY-----\n MIIEvgI... \n -----END PRIVATE KEY----- \n -----BEGIN CERTIFICATE----- \n MIICoTC... \n -----END CERTIFICATE-----"
      - name: azureCertificateFile
        sensitive: true
        required: false
        description: "Path to PFX/PKCS#12 file on disk, containing the certificate and private key."
        example: "/path/to/file.pem"
      - name: azureCertificatePassword
        sensitive: true
        required: false
        description: "Password for the certificate if encrypted."
        example: "password"
metadata:
  - name: host
    description: "Endpoint for the Azure App Configuration instance. Mutally exclusive with connectionString field. To be used when Azure Authentication is used"
    type: string
    example: '"https://dapr.azconfig.io"'
  - name: maxRetries
    description: "Maximum number of retries before giving up"
    type: number
    default: '3'
    example: '10'
  - name: retryDelay
    description: "RetryDelay specifies the initial amount of delay to use before retrying an operation. The delay increases exponentially with each retry up to the maximum specified by MaxRetryDelay. Defaults to 4 seconds. -1 disables delay between retries."
    type: number
    default: '4000000000'
    example: '5000000000'
  - name: maxRetryDelay
    description: "MaxRetryDelay specifies the maximum delay allowed before retrying an operation. Typically the value is greater than or equal to the value specified in RetryDelay. Defaults to 120 seconds. -1 disables the limit."
    type: number
    default: '120000000000'
    example: '180000000000'
  - name: subscribePollInterval
    description: "Specifies the poll interval for polling the subscribed keys for any changes. Default polling interval is set to 24 hours."
    type: number
    default: '86400000000000'
    example: '240000000000'